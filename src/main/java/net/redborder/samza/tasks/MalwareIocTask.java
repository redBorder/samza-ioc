package net.redborder.samza.tasks;

import net.redborder.samza.util.AerospikeStore;
import org.apache.samza.config.Config;
import org.apache.samza.storage.kv.KeyValueStore;
import org.apache.samza.system.IncomingMessageEnvelope;
import org.apache.samza.task.*;

import java.util.Map;

public class MalwareIocTask implements StreamTask, InitableTask {
    AerospikeStore aerospikeStore;
    KeyValueStore<String, Map<String, Object>> localStore;
    @Override
    public void init(Config config, TaskContext taskContext) throws Exception {
        this.aerospikeStore = new AerospikeStore(config);
        this.localStore = (KeyValueStore<String, Map<String, Object>>) taskContext.getStore("ioc");
    }

    @Override
    public void process(IncomingMessageEnvelope messageEnvelope, MessageCollector collector, TaskCoordinator taskCoordinator) throws Exception {
        String message = (String) messageEnvelope.getMessage();
    }
}
